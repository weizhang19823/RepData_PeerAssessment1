---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---
```{ r packages}
##load all packages that need in this ananlysis
library(knitr)
library(dplry)
library(ggplot2)
```
```{ r setoptions, echo=TRUE}
ops_chunks$set(echo=TRUE)
```


## Loading and preprocessing the data
```{r loaddata}
unzip(zipfile="activity.zip")
activity<-read.csv("activity.csv",header=T,sep=",")
```
## What is mean total number of steps taken per day?
```{r}
total.steps<-tapply(activity$steps,activity$date, sum, na.rm=TRUE)
qplot(total.steps,binwidth=1000,xlab="Total number of steps taken per day)
mean(total.steps, na.rm=TRUE)
median(total.steps, na.rm=TRUE)
```

## What is the average daily activity pattern?
```{r}
mn_int <- tapply(activity$steps, activity$interval, mean, na.rm=TRUE)
plot(mn_int ~ unique(activity$interval), type="l", xlab = "5-min interval")
```
5-minute interval, on average across all the days in the dataset, which contains the maximum number of steps
```{r}
mn_int[which.max(mn_int)]
```


## Imputing missing values
```{r how_many_missing}
miss <- is.na(activity$steps)
# How many miss
table(miss)
```
Strategy for filling in all of the missing values in the dataset: replace any NA with the mean of the corresponding interval

New dataset that is equal to the original dataset but with the missing data filled in
```{r}
activity3 <- activity
for (i in 1:nrow(activity)){
    if(is.na(activity$steps[i])){
        activity3$steps[i]<- mn_int[[as.character(activity[i, "interval"])]]
    }
}
```

Histogram of the total number of steps taken each day
```{r}
summary <- tapply(activity3$steps, activity3$date, sum, na.rm=TRUE)
hist(summary, xlab = "Steps sum", main = "Steps per day")
```
New mean and median total number of steps taken per day
```{r}
mean(summary, na.rm=TRUE)
median(summary, na.rm=TRUE)
```
Mean and median value almost the same after we filled in the missing value with the mean steps for that 5-minute interval. 

## Are there differences in activity patterns between weekdays and weekends?


